#!/bin/withenv sh

set -euo pipefail
export BF_X=`basename ${0}`


#======================================================================================================================
# Ensure requested cron directory exists
#======================================================================================================================

PERIOD=${1-}
[[ -n "${PERIOD}" ]] || bf-write-error "You must pass the name of the directory to run."

DIR=${BF_CRON_D}/${PERIOD}
[[ -d "${DIR}" ]] || bf-write-error "Directory ${DIR} does not exist."


#======================================================================================================================
# Store date / time this cron directory was last run
#======================================================================================================================

echo $(date '+%Y-%m-%d %H:%M:%S') > ${BF_CRON_LOG}/${PERIOD}


#======================================================================================================================
# Execute requested cron directory
#======================================================================================================================

run-parts --exit-on-error ${DIR}
